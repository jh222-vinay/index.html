<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Standard Hindi-English Note Translator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <!-- KaTeX for Science Symbols -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Lora:ital,wght@0,400;0,700;1,400&display=swap');
        
        body { background-color: #f3f4f6; font-family: 'Inter', sans-serif; }
        
        .pdf-page-render {
            font-family: 'Lora', serif;
            background: white;
            width: 210mm;
            min-height: 297mm;
            padding: 20mm 25mm;
            margin: 20px auto;
            color: #111827;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            line-height: 1.6;
            font-size: 11pt;
        }

        .pdf-page-render h1 { font-weight: 700; font-size: 22pt; text-align: center; margin-bottom: 1.5rem; color: #111827; }
        .pdf-page-render h2 { font-weight: 700; font-size: 16pt; margin-top: 1.5rem; color: #374151; border-bottom: 1px solid #e5e7eb; }
        .pdf-page-render p { margin-bottom: 1rem; text-align: justify; }

        .page-break { page-break-after: always; height: 0; }
        .loader-bar { height: 4px; width: 0%; background: #2563eb; transition: width 0.3s; }
    </style>
</head>
<body class="pb-10">

    <nav class="bg-white border-b sticky top-0 z-50 px-4 py-3">
        <div class="max-w-5xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="bg-blue-600 p-2 rounded-lg text-white">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 11.37 9.188 16.524 5 20" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                </div>
                <h1 class="font-bold text-lg text-slate-800">Simple Translator</h1>
            </div>
            
            <div class="flex gap-2">
                <label class="bg-slate-100 hover:bg-slate-200 text-slate-800 px-4 py-2 rounded-lg font-semibold cursor-pointer text-sm">
                    Upload Images
                    <input type="file" id="image-input" class="hidden" accept="image/*" multiple>
                </label>
                <button id="download-btn" class="hidden bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold text-sm">
                    Save PDF
                </button>
            </div>
        </div>
        <div class="w-full bg-slate-100 mt-3 h-1"><div id="progress" class="loader-bar"></div></div>
    </nav>

    <div id="canvas-area" class="max-w-5xl mx-auto px-4 mt-6">
        <div id="welcome" class="text-center py-20 bg-white rounded-2xl border-2 border-dashed border-slate-300">
            <p class="text-slate-400 font-medium">Select Hindi notes to translate into English</p>
        </div>
    </div>

    <script>
        const apiKey = "AIzaSyA8sL--8pnJ5sT0gM-8sBVX1pAVX1TQc9Q"; // Use your Google AI Studio Key
        const input = document.getElementById('image-input');
        const canvasArea = document.getElementById('canvas-area');
        const welcome = document.getElementById('welcome');
        const downloadBtn = document.getElementById('download-btn');
        const progress = document.getElementById('progress');

        input.onchange = async (e) => {
            const files = Array.from(e.target.files);
            if (!files.length) return;

            welcome.classList.add('hidden');
            canvasArea.innerHTML = '';
            downloadBtn.classList.add('hidden');

            for (let i = 0; i < files.length; i++) {
                progress.style.width = `${((i+1)/files.length)*100}%`;
                const base64 = await toBase64(files[i]);
                const content = await fetchTranslation(base64);
                
                const page = document.createElement('div');
                page.className = 'pdf-page-render';
                page.innerHTML = content;
                canvasArea.appendChild(page);

                renderMathInElement(page, {
                    delimiters: [{left: '$', right: '$', display: false}, {left: '$$', right: '$$', display: true}],
                    throwOnError: false
                });
const apiKey = "AIzaSyA8sL--8pnJ5sT0gM-8sBVX1pAVX1TQc9Q";
                if (i < files.length - 1) {
                    const separator = document.createElement('div');
                    separator.className = 'page-break';
                    canvasArea.appendChild(separator);
                }
            }
            downloadBtn.classList.remove('hidden');
        };

        async function fetchTranslation(base64) {
            const prompt = `Translate all text from this Hindi note into clean English. 
            - NO Hindi script in the output.
            - Use <h1> for titles and <h2> for subheadings.
            - Use LaTeX $...$ for all scientific formulas/symbols.
            - Maintain the original sequence of information.
            - Output ONLY the HTML tags.`;

            const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{ parts: [
                        { text: prompt },
                        { inlineData: { mimeType: "image/png", data: base64 } }
                    ]}]
                })
            });

            const data = await res.json();
            return data.candidates[0].content.parts[0].text.replace(/```html|```/g, '').trim();
        }

        const toBase64 = f => new Promise((res, rej) => {
            const r = new FileReader(); r.readAsDataURL(f);
            r.onload = () => res(r.result.split(',')[1]);
            r.onerror = rej;
        });

        downloadBtn.onclick = () => {
            html2pdf().from(canvasArea).set({
                margin: 0,
                filename: 'Notes_Translation.pdf',
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            }).save();
        };
    </script>
</body>
</html>

